from PyQt5 import QtWidgets, QtCore, QtGui

import dataBlockMenu

class field(QtWidgets.QWidget):
    def __init__(self, parent, **kwargs):
        super().__init__(**kwargs)

        self.parent = parent

        vboxLayout = QtWidgets.QVBoxLayout()
        self.setLayout(vboxLayout)

        # Head
        headWidget = QtWidgets.QWidget()
        p1 = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred
                                   , QtWidgets.QSizePolicy.Preferred)
        p1.setVerticalStretch(2)
        headWidget.setSizePolicy(p1)
        palette = QtGui.QPalette()
        palette.setColor(QtGui.QPalette.Background, 
                         QtGui.QColor(200, 200, 200, 255))
        headWidget.setAutoFillBackground(True)
        headWidget.setPalette(palette)

        addButton = QtWidgets.QPushButton()
        addButton.setText("選擇方塊")
        addButton.setFixedSize(QtCore.QSize(100, 50))
        popupMenu = dataBlockMenu.dataBlockMenu(self)
        addButton.setMenu(popupMenu)

        previewButton = QtWidgets.QPushButton()
        previewButton.setText("預覽")
        previewButton.setFixedSize(QtCore.QSize(50, 25))
        previewButton.pressed.connect(parent.actions["viewExportedExcel"].trigger)
        exportButton = QtWidgets.QPushButton()
        exportButton.setText("輸出")
        exportButton.setFixedSize(QtCore.QSize(50, 25))
        exportButton.pressed.connect(parent.actions["exportExcel"].trigger)
        hboxLayout1 = QtWidgets.QHBoxLayout()
        hboxLayout1.addWidget(previewButton)
        hboxLayout1.addWidget(exportButton)
        hboxLayout1.setAlignment(QtCore.Qt.AlignRight)

        hboxLayout2 = QtWidgets.QHBoxLayout()
        hboxLayout2.setContentsMargins(25, 5, 25, 5)
        hboxLayout2.addWidget(addButton)
        hboxLayout2.addLayout(hboxLayout1)
        headWidget.setLayout(hboxLayout2)

        # Body
        bodyWidget = QtWidgets.QWidget()
        self.gridLayout = QtWidgets.QGridLayout()
        self.gridLayout.setContentsMargins(25, 25, 25, 25)
        self.gridLayout.setVerticalSpacing(25)
        bodyWidget.setLayout(self.gridLayout)

        for i in range(15):
            le = QtWidgets.QLineEdit()
            le.setPlaceholderText(self.tr("欄位名稱"))
            self.gridLayout.addWidget(le, i, 0, QtCore.Qt.AlignLeft)

        self.scrollArea = QtWidgets.QScrollArea()
        self.scrollArea.setWidget(bodyWidget)
        p2 = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred
                                   , QtWidgets.QSizePolicy.Preferred)
        p2.setVerticalStretch(14)
        self.scrollArea.setSizePolicy(p2)

        vboxLayout.addWidget(headWidget)
        vboxLayout.addWidget(self.scrollArea)
    

